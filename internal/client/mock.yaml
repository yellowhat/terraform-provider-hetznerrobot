---
openapi: 3.0.0
info:
  title: Robot Webservice API
  version: 1.0.0
  description: API for managing servers, IPs, boot configurations, firewalls, and vSwitches.

security:
  - basicAuth: []

components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic

  responses:
    UnauthorizedError:
      description: Authentication failed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              status: 401
              code: UNAUTHORIZED
              message: Authentication failed

    ErrorResponse:
      description: Error response
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    RateLimitExceeded:
      description: Rate limit exceeded
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              status: 403
              code: RATE_LIMIT_EXCEEDED
              max_request: 200
              interval: 3600
              message: rate limit exceeded

    Maintenance:
      description: Service Unavailable due to maintenance
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
          example:
            error:
              status: 503
              code: SERVICE_UNAVAILABLE
              message: Service Unavailable due to maintenance

  schemas:
    Error:
      type: object
      properties:
        error:
          type: object
          properties:
            status:
              type: integer
            code:
              type: string
            message:
              type: string
            missing:
              type: array
              items:
                type: string
            invalid:
              type: array
              items:
                type: string

    Server:
      type: object
      properties:
        server_ip:
          type: string
        server_ipv6_net:
          type: string
        server_number:
          type: integer
        server_name:
          type: string
        product:
          type: string
        dc:
          type: string
        traffic:
          type: string
        status:
          type: string
        cancelled:
          type: boolean
        paid_until:
          type: string
        ip:
          type: array
          items:
            type: string
        subnet:
          type: array
          items:
            $ref: '#/components/schemas/Subnet'
        reset:
          type: boolean
        rescue:
          type: boolean
        vnc:
          type: boolean
        windows:
          type: boolean
        plesk:
          type: boolean
        cpanel:
          type: boolean
        wol:
          type: boolean
        hot_swap:
          type: boolean
        linked_storagebox:
          type: integer

    Subnet:
      type: object
      properties:
        ip:
          type: string
        mask:
          type: string

    Cancellation:
      type: object
      properties:
        server_ip:
          type: string
        server_ipv6_net:
          type: string
        server_number:
          type: integer
        server_name:
          type: string
        earliest_cancellation_date:
          type: string
        cancelled:
          type: boolean
        reserved:
          type: boolean
        reservation_possible:
          type: boolean
        cancellation_date:
          type: string
        cancellation_reason:
          type: array
          items:
            type: string

    IP:
      type: object
      properties:
        ip:
          type: string
        server_ip:
          type: string
        server_number:
          type: integer
        locked:
          type: boolean
        separate_mac:
          type: string
        traffic_warnings:
          type: boolean
        traffic_hourly:
          type: integer
        traffic_daily:
          type: integer
        traffic_monthly:
          type: integer
        gateway:
          type: string
        mask:
          type: integer
        broadcast:
          type: string

    MAC:
      type: object
      properties:
        ip:
          type: string
        mac:
          type: string

    Reset:
      type: object
      properties:
        server_ip:
          type: string
        server_ipv6_net:
          type: string
        server_number:
          type: integer
        type:
          type: array
          items:
            type: string
        operating_status:
          type: string

    Boot:
      type: object
      properties:
        rescue:
          $ref: '#/components/schemas/BootConfig'
        linux:
          $ref: '#/components/schemas/BootConfig'
        vnc:
          $ref: '#/components/schemas/BootConfig'
        windows:
          $ref: '#/components/schemas/BootConfig'
        plesk:
          $ref: '#/components/schemas/BootConfig'
        cpanel:
          $ref: '#/components/schemas/BootConfig'

    BootConfig:
      type: object
      properties:
        server_ip:
          type: string
        server_ipv6_net:
          type: string
        server_number:
          type: integer
        os:
          type: array
          items:
            type: string
        arch:
          type: array
          items:
            type: integer
        active:
          type: boolean
        password:
          type: string
        authorized_key:
          type: array
          items:
            type: string
        host_key:
          type: array
          items:
            type: string
        dist:
          type: array
          items:
            type: string
        lang:
          type: array
          items:
            type: string
        hostname:
          type: string

    Firewall:
      type: object
      properties:
        server_ip:
          type: string
        server_number:
          type: integer
        status:
          type: string
        filter_ipv6:
          type: boolean
        whitelist_hos:
          type: boolean
        port:
          type: string
        rules:
          $ref: '#/components/schemas/FirewallRules'

    FirewallRules:
      type: object
      properties:
        input:
          type: array
          items:
            $ref: '#/components/schemas/FirewallRule'
        output:
          type: array
          items:
            $ref: '#/components/schemas/FirewallRule'

    FirewallRule:
      type: object
      properties:
        ip_version:
          type: string
        name:
          type: string
        dst_ip:
          type: string
        src_ip:
          type: string
        dst_port:
          type: string
        src_port:
          type: string
        protocol:
          type: string
        tcp_flags:
          type: string
        action:
          type: string

    vSwitch:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        vlan:
          type: integer
        cancelled:
          type: boolean
        server:
          type: array
          items:
            $ref: '#/components/schemas/vSwitchServer'
        subnet:
          type: array
          items:
            $ref: '#/components/schemas/vSwitchSubnet'
        cloud_network:
          type: array
          items:
            $ref: '#/components/schemas/vSwitchCloudNetwork'

    vSwitchServer:
      type: object
      properties:
        server_ip:
          type: string
        server_ipv6_net:
          type: string
        server_number:
          type: integer
        status:
          type: string

    vSwitchSubnet:
      type: object
      properties:
        ip:
          type: string
        mask:
          type: integer
        gateway:
          type: string

    vSwitchCloudNetwork:
      type: object
      properties:
        id:
          type: integer
        ip:
          type: string
        mask:
          type: integer
        gateway:
          type: string

paths:
  /server:
    get:
      summary: Query data of all servers
      operationId: getServers
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Server'
              example:
                - server_name: "server-1"
                  server_number: 1
                  server_ip: "88.99.100.1"
                  dc: "fsn1-dc14"
                  product: "AX41"
                  status: "running"
                - server_name: "server-2"
                  server_number: 2
                  server_ip: "88.99.100.2"
                  dc: "fsn1-dc14"
                  product: "AX51"
                  status: "running"
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /server/{server-number}:
    get:
      summary: Query server data for a specific server
      operationId: getServer
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Server'
              example:
                server_name: "test-server"
                server_number: 123456
                server_ip: "88.99.100.100"
                dc: "fsn1-dc14"
                product: "AX41"
                status: "running"
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Update server name for a specific server
      operationId: updateServerName
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                server_name:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Server'
              example:
                server_name: "updated-server-name"
                server_number: 123456
                server_ip: "88.99.100.100"
                dc: "fsn1-dc14"
                product: "AX41"
                status: "running"
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /server/{server-number}/cancellation:
    get:
      summary: Query cancellation data for a server
      operationId: getServerCancellation
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cancellation'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Cancel a server
      operationId: cancelServer
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                cancellation_date:
                  type: string
                cancellation_reason:
                  type: string
                reserve_location:
                  type: boolean
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cancellation'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Withdraw a server cancellation
      operationId: withdrawServerCancellation
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /ip:
    get:
      summary: Query list of all single IP addresses
      operationId: getIPs
      parameters:
        - name: server_ip
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/IP'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /ip/{ip}:
    get:
      summary: Query data for a specific IP address
      operationId: getIP
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IP'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Update traffic warning options for an IP address
      operationId: updateIPTrafficWarnings
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                traffic_warnings:
                  type: boolean
                traffic_hourly:
                  type: integer
                traffic_daily:
                  type: integer
                traffic_monthly:
                  type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IP'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /ip/{ip}/mac:
    get:
      summary: Query if it is possible to set a separate MAC address
      operationId: getIPMAC
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MAC'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    put:
      summary: Generate a separate MAC address
      operationId: generateIPMAC
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MAC'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Remove a separate MAC address
      operationId: deleteIPMAC
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MAC'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /ip/{ip}/cancellation:
    get:
      summary: Query cancellation data for an IP
      operationId: getIPCancellation
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cancellation'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Cancel an IP address
      operationId: cancelIP
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                cancellation_date:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cancellation'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Revoke an IP cancellation
      operationId: revokeIPCancellation
      parameters:
        - name: ip
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cancellation'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /reset:
    get:
      summary: Query reset options for all servers
      operationId: getResets
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Reset'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /reset/{server-number}:
    get:
      summary: Query reset options for a specific server
      operationId: getReset
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reset'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Execute reset on specific server
      operationId: executeReset
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                type:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reset'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}:
    get:
      summary: Query the current boot configuration status for a server
      operationId: getBootConfig
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Boot'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}/rescue:
    get:
      summary: Query boot options for the Rescue System
      operationId: getRescueBootConfig
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Activate Rescue System
      operationId: activateRescue
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                os:
                  type: string
                arch:
                  type: integer
                authorized_key:
                  type: array
                  items:
                    type: string
                keyboard:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Deactivate Rescue System
      operationId: deactivateRescue
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}/rescue/last:
    get:
      summary: Show data of last rescue activation
      operationId: getLastRescueActivation
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}/linux:
    get:
      summary: Query boot options for the Linux installation
      operationId: getLinuxBootConfig
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Activate Linux installation
      operationId: activateLinux
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                dist:
                  type: string
                arch:
                  type: integer
                lang:
                  type: string
                authorized_key:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Deactivate Linux installation
      operationId: deactivateLinux
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}/vnc:
    get:
      summary: Query boot options for the VNC installation
      operationId: getVNCBootConfig
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Activate VNC installation
      operationId: activateVNC
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                dist:
                  type: string
                arch:
                  type: integer
                lang:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Deactivate VNC installation
      operationId: deactivateVNC
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}/windows:
    get:
      summary: Query boot options for the Windows installation
      operationId: getWindowsBootConfig
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Activate Windows installation
      operationId: activateWindows
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                lang:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Deactivate Windows installation
      operationId: deactivateWindows
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}/plesk:
    get:
      summary: Query boot options for the Plesk installation
      operationId: getPleskBootConfig
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Activate Plesk installation
      operationId: activatePlesk
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                dist:
                  type: string
                arch:
                  type: integer
                lang:
                  type: string
                hostname:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Deactivate Plesk installation
      operationId: deactivatePlesk
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /boot/{server-number}/cpanel:
    get:
      summary: Query boot options for the cPanel installation
      operationId: getCPanelBootConfig
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Activate cPanel installation
      operationId: activateCPanel
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                dist:
                  type: string
                arch:
                  type: integer
                lang:
                  type: string
                hostname:
                  type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Deactivate cPanel installation
      operationId: deactivateCPanel
      parameters:
        - name: server-number
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BootConfig'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '500':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /firewall/{server-id}:
    get:
      summary: Get the firewall configuration for a server
      operationId: getFirewallConfig
      parameters:
        - name: server-id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Firewall'
              example:
                firewall:
                  ip: "1.2.3.4"
                  whitelist_hos: true
                  status: "active"
                  rules:
                    input:
                      - name: allow-ssh
                        src_ip: 0.0.0.0/0
                        dst_port: "22"
                        protocol: tcp
                        action: accept
                      - name: allow-http
                        src_ip: 0.0.0.0/0
                        dst_port: "80"
                        protocol: tcp
                        action: accept
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Apply a new firewall configuration
      operationId: applyFirewallConfig
      parameters:
        - name: server-id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                status:
                  type: string
                filter_ipv6:
                  type: boolean
                whitelist_hos:
                  type: boolean
                rules:
                  type: object
                  additionalProperties:
                    type: array
                    items:
                      type: object
                      properties:
                        ip_version:
                          type: string
                        name:
                          type: string
                        dst_ip:
                          type: string
                        src_ip:
                          type: string
                        dst_port:
                          type: string
                        src_port:
                          type: string
                        protocol:
                          type: string
                        tcp_flags:
                          type: string
                        action:
                          type: string
                template_id:
                  type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Firewall'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Clear firewall configuration of a server
      operationId: clearFirewallConfig
      parameters:
        - name: server-id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Firewall'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /vswitch:
    get:
      summary: Query data of all vSwitches
      operationId: getvSwitches
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/vSwitch'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Create a new vSwitch
      operationId: createvSwitch
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                name:
                  type: string
                vlan:
                  type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/vSwitch'
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /vswitch/{vswitch-id}:
    get:
      summary: Query data of a specific vSwitch
      operationId: getvSwitch
      parameters:
        - name: vswitch-id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/vSwitch'
        '404':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    post:
      summary: Change the name or the VLAN ID of a vSwitch
      operationId: updatevSwitch
      parameters:
        - name: vswitch-id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                name:
                  type: string
                vlan:
                  type: integer
      responses:
        '200':
          description: Successful response
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Cancel a vSwitch
      operationId: cancelvSwitch
      parameters:
        - name: vswitch-id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                cancellation_date:
                  type: string
      responses:
        '200':
          description: Successful response
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

  /vswitch/{vswitch-id}/server:
    post:
      summary: Add one or more servers to a vSwitch
      operationId: addServerstovSwitch
      parameters:
        - name: vswitch-id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                server:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Successful response
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []

    delete:
      summary: Delete one or more servers from a vSwitch
      operationId: deleteServerstovSwitch
      parameters:
        - name: vswitch-id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                server:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Successful response
        '400':
          $ref: '#/components/responses/ErrorResponse'
        '404':
          $ref: '#/components/responses/ErrorResponse'
        '409':
          $ref: '#/components/responses/ErrorResponse'
      security:
        - basicAuth: []
